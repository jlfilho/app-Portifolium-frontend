<div class="dialog-container">
  <div class="dialog-header">
    <div class="header-content">
      <mat-icon class="header-icon">lock_reset</mat-icon>
      <div class="header-text">
        <h2 mat-dialog-title>Alterar Senha</h2>
        <p class="subtitle">{{ data.usuarioNome }}</p>
      </div>
    </div>
  </div>

  <mat-dialog-content class="dialog-content">
    <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
      <!-- Senha Atual -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Senha Atual</mat-label>
        <mat-icon matPrefix>lock</mat-icon>
        <input
          matInput
          type="password"
          formControlName="currentPassword"
          placeholder="Digite sua senha atual"
          autocomplete="current-password">
        <mat-error *ngIf="currentPassword?.hasError('required')">
          Senha atual é obrigatória
        </mat-error>
        <mat-error *ngIf="currentPassword?.hasError('minlength')">
          Mínimo de 6 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Nova Senha -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nova Senha</mat-label>
        <mat-icon matPrefix>lock_open</mat-icon>
        <input
          matInput
          type="password"
          formControlName="newPassword"
          placeholder="Digite a nova senha"
          autocomplete="new-password">
        <mat-hint>Mínimo de 6 caracteres</mat-hint>
        <mat-error *ngIf="newPassword?.hasError('required')">
          Nova senha é obrigatória
        </mat-error>
        <mat-error *ngIf="newPassword?.hasError('minlength')">
          Mínimo de 6 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Confirmar Senha -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirmar Nova Senha</mat-label>
        <mat-icon matPrefix>check_circle</mat-icon>
        <input
          matInput
          type="password"
          formControlName="confirmPassword"
          placeholder="Digite novamente a nova senha"
          autocomplete="new-password">
        <mat-error *ngIf="confirmPassword?.hasError('required')">
          Confirmação é obrigatória
        </mat-error>
        <mat-error *ngIf="confirmPassword?.hasError('minlength')">
          Mínimo de 6 caracteres
        </mat-error>
        <mat-error *ngIf="passwordForm.hasError('passwordMismatch') && confirmPassword?.touched">
          As senhas não coincidem
        </mat-error>
      </mat-form-field>

      <!-- Info Box -->
      <div class="info-box">
        <mat-icon>info</mat-icon>
        <div>
          <strong>Importante:</strong>
          A senha deve ter pelo menos 6 caracteres e será aplicada imediatamente após a confirmação.
        </div>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button
      mat-button
      type="button"
      (click)="onCancel()"
      [disabled]="isSaving">
      <mat-icon>close</mat-icon>
      Cancelar
    </button>

    <button
      mat-raised-button
      color="primary"
      type="button"
      (click)="onSubmit()"
      [disabled]="isSaving || passwordForm.invalid">
      <mat-icon>{{ isSaving ? 'hourglass_empty' : 'save' }}</mat-icon>
      {{ isSaving ? 'Salvando...' : 'Alterar Senha' }}
    </button>
  </mat-dialog-actions>
</div>

